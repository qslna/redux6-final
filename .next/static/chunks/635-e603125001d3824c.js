"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[635],{4373:(e,t,a)=>{a.d(t,{A:()=>j});var s=a(5155),i=a(2115),l=a(5683),r=a(5427),n=a(6989),c=a(4505),o=a(3473),d=a(8684),h=a(9191),m=a(767),u=a(2725),p=a(650),x=a(5220),g=a(7820),f=a(6265);function j(e){let{folder:t,layout:a="grid",maxItems:j,title:w,className:b="",acceptedTypes:v="all",columns:y=3,stackStyle:N="default",href:k}=e,[I,S]=(0,i.useState)([]),[E,A]=(0,i.useState)(!0),[C,P]=(0,i.useState)(!1),[_,q]=(0,i.useState)(null),[z,T]=(0,i.useState)(null),[K,M]=(0,i.useState)(new Set),[F,L]=(0,i.useState)(new Set),[D,G]=(0,i.useState)(0),O=(0,i.useRef)(null),{isAdmin:W}=(0,n.z)(),J=async()=>{try{A(!0),q(null);let e=await fetch("/api/imagekit/list?folder=".concat(t,"&limit=50"));if(!e.ok)throw Error("미디어를 불러올 수 없습니다");let a=(await e.json()).filter(e=>{let t=/\.(jpg|jpeg|png|gif|webp|avif)$/i.test(e.name),a=/\.(mp4|webm|ogg|mov|avi)$/i.test(e.name);return"images"===v?t:"videos"===v?a:t||a}).map(e=>{let t=/\.(mp4|webm|ogg|mov|avi)$/i.test(e.name);return{url:e.url,fileId:e.fileId,name:e.name,path:e.filePath,type:t?"video":"image",thumbnail:t?"".concat(e.url,"?tr=f-jpg,q-80"):e.url}}),s=j?a.slice(0,j):a;S(s)}catch(e){console.error("미디어 로드 오류:",e),q(e instanceof Error?e.message:"미디어 로드 실패")}finally{A(!1)}};(0,i.useEffect)(()=>{J()},[t,j,v]);let R=async e=>{if(e&&0!==e.length&&W)try{P(!0),G(0);for(let a=0;a<e.length;a++){let s=e[a],i=new FormData;if(i.append("file",s),i.append("folder",t),!(await fetch("/api/imagekit/upload",{method:"POST",body:i})).ok)throw Error("".concat(s.name," 업로드 실패"));G((a+1)/e.length*100)}await J()}catch(e){console.error("업로드 오류:",e),q(e instanceof Error?e.message:"업로드에 실패했습니다")}finally{P(!1),G(0)}},$=async(e,t)=>{if(W&&confirm("'".concat(t,"'을(를) 삭제하시겠습니까?")))try{if(!(await fetch("/api/imagekit/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileId:e})})).ok)throw Error("삭제 실패");await J()}catch(e){console.error("삭제 오류:",e),q("삭제에 실패했습니다")}},B=e=>{M(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},H=e=>{L(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},U=()=>{switch(v){case"images":return"image/*";case"videos":return"video/*";default:return"image/*,video/*"}};if(E)return(0,s.jsxs)("div",{className:"flex items-center justify-center p-8 ".concat(b),children:[(0,s.jsx)(c.A,{className:"w-8 h-8 animate-spin text-white/60"}),(0,s.jsx)("span",{className:"ml-2 text-white/60",children:"로딩 중..."})]});if(_)return(0,s.jsxs)("div",{className:"text-center p-8 ".concat(b),children:[(0,s.jsx)("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 mb-4",children:(0,s.jsx)("p",{className:"text-red-300",children:_})}),(0,s.jsx)("button",{onClick:J,className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:"다시 시도"})]});if("stack"===a){let e={default:{spread:15,rotation:8,scale:.95},spread:{spread:25,rotation:12,scale:.9},minimal:{spread:8,rotation:4,scale:.98}}[N];return(0,s.jsxs)("div",{className:b,children:[w&&(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4 text-center text-white",children:w}),W&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("input",{ref:O,type:"file",accept:U(),multiple:!0,onChange:e=>{e.target.files&&R(e.target.files)},className:"hidden",disabled:C}),(0,s.jsx)("button",{onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},disabled:C,className:"w-full flex items-center justify-center gap-2 p-3 bg-white/10 hover:bg-white/20 rounded-lg cursor-pointer transition-colors disabled:opacity-50",children:C?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{className:"w-4 h-4 animate-spin"}),(0,s.jsxs)("span",{className:"text-sm",children:[Math.round(D),"%"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm",children:"미디어 추가"})]})})]}),(0,s.jsxs)("div",{className:"relative w-full aspect-square group cursor-pointer",onClick:()=>{k&&window.open(k,"_blank")},style:{height:"400px"},children:[(0,s.jsx)(l.N,{children:0===I.length?(0,s.jsx)(r.P.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full h-full border-2 border-dashed border-white/30 rounded-lg flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center text-white/50",children:[(0,s.jsx)(d.A,{className:"w-8 h-8 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm",children:"미디어가 없습니다"}),W&&(0,s.jsx)("p",{className:"text-xs mt-1",children:"위의 버튼을 클릭하여 추가하세요"})]})}):I.map((t,a)=>(0,s.jsxs)(r.P.div,{className:"absolute inset-0 rounded-lg overflow-hidden shadow-xl cursor-pointer",initial:{opacity:0,scale:.8,rotate:0,x:0,y:0},animate:{opacity:1-.1*a,scale:e.scale-.02*a,rotate:(a-Math.floor(I.length/2))*e.rotation,x:(a-Math.floor(I.length/2))*e.spread,y:3*a,zIndex:I.length-a},whileHover:{scale:(e.scale-.02*a)*1.02,transition:{duration:.2}},onClick:e=>{k||(e.stopPropagation(),T(t))},style:{zIndex:I.length-a},children:["video"===t.type?(0,s.jsxs)("div",{className:"relative w-full h-full bg-black",children:[(0,s.jsx)("video",{src:t.url,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:(0,s.jsx)(h.A,{className:"w-12 h-12 text-white opacity-80"})})]}):(0,s.jsx)("img",{src:(0,f.Nu)(t.url,{width:400,height:500,quality:85,format:"webp"}),alt:t.name,className:"object-cover"}),W&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),$(t.fileId,t.name)},className:"absolute top-2 right-2 p-1 bg-red-500 hover:bg-red-600 rounded-full opacity-0 group-hover:opacity-100 transition-opacity z-10",children:(0,s.jsx)(m.A,{className:"w-3 h-3 text-white"})})]},t.fileId))}),k&&I.length>0&&(0,s.jsx)(r.P.div,{className:"absolute inset-0 bg-black/20 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center pointer-events-none",style:{zIndex:1e3},children:(0,s.jsx)("span",{className:"text-white font-medium",children:"클릭하여 보기"})})]}),(0,s.jsx)("div",{className:"text-center mt-4",children:(0,s.jsxs)("span",{className:"text-xs text-white/60",children:[I.length,"개 미디어"]})})]})}return(0,s.jsxs)("div",{className:b,children:[w&&(0,s.jsx)("h3",{className:"text-2xl font-bold mb-6 text-center text-white",children:w}),W&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("input",{ref:O,type:"file",accept:U(),multiple:!0,onChange:e=>{e.target.files&&R(e.target.files)},className:"hidden",disabled:C}),(0,s.jsx)("button",{onClick:()=>{var e;return null===(e=O.current)||void 0===e?void 0:e.click()},disabled:C,className:"flex items-center gap-2 px-4 py-2 bg-white text-black font-medium rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:C?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{className:"w-4 h-4 animate-spin"}),"업로드 중... ",Math.round(D),"%"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{className:"w-4 h-4"}),"미디어 추가"]})})]}),(0,s.jsx)("div",{className:(()=>{switch(a){case"grid":return"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-".concat(y);case"masonry":return"columns-1 sm:columns-2 lg:columns-3 gap-4 space-y-4";case"carousel":return"flex gap-4 overflow-x-auto pb-4";case"stack":return"relative w-full max-w-sm mx-auto";default:return"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"}})(),children:(0,s.jsx)(l.N,{children:0===I.length?(0,s.jsx)(r.P.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-full flex items-center justify-center p-12 border-2 border-dashed border-white/30 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center text-white/50",children:[(0,s.jsx)(d.A,{className:"w-12 h-12 mx-auto mb-4"}),(0,s.jsx)("p",{children:"미디어가 없습니다"}),W&&(0,s.jsx)("p",{className:"text-sm mt-2",children:"위의 버튼을 클릭하여 추가하세요"})]})}):I.map((e,t)=>(0,s.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},transition:{delay:.1*t},className:"relative group cursor-pointer ".concat("carousel"===a?"flex-shrink-0 w-64":""),onClick:()=>T(e),children:[(0,s.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-900",children:["video"===e.type?(0,s.jsxs)("div",{className:"relative w-full h-full",children:[(0,s.jsx)("video",{src:e.url,className:"w-full h-full object-cover",muted:F.has(e.fileId),autoPlay:K.has(e.fileId),loop:!0,playsInline:!0}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-colors flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),B(e.fileId)},className:"p-2 bg-white/20 hover:bg-white/30 rounded-full",children:K.has(e.fileId)?(0,s.jsx)(u.A,{className:"w-4 h-4 text-white"}):(0,s.jsx)(h.A,{className:"w-4 h-4 text-white"})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),H(e.fileId)},className:"p-2 bg-white/20 hover:bg-white/30 rounded-full",children:F.has(e.fileId)?(0,s.jsx)(p.A,{className:"w-4 h-4 text-white"}):(0,s.jsx)(x.A,{className:"w-4 h-4 text-white"})})]})}),(0,s.jsx)("div",{className:"absolute top-2 left-2",children:(0,s.jsx)(g.A,{className:"w-4 h-4 text-white"})})]}):(0,s.jsx)("img",{src:(0,f.Nu)(e.url,{width:300,height:300,quality:85,format:"webp"}),alt:e.name,className:"object-cover group-hover:scale-105 transition-transform duration-300"}),W&&(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),$(e.fileId,e.name)},className:"absolute top-2 right-2 p-1 bg-red-500 hover:bg-red-600 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(m.A,{className:"w-3 h-3 text-white"})})]}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("p",{className:"text-sm text-white/80 truncate",children:e.name})})]},e.fileId))})}),(0,s.jsx)(l.N,{children:z&&(0,s.jsx)(r.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:()=>T(null),children:(0,s.jsxs)(r.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:e=>e.stopPropagation(),children:["video"===z.type?(0,s.jsx)("video",{src:z.url,controls:!0,autoPlay:!0,className:"max-w-full max-h-full rounded-lg"}):(0,s.jsx)("img",{src:z.url,alt:z.name,width:1200,height:800,className:"max-w-full max-h-full object-contain rounded-lg"}),(0,s.jsx)("button",{onClick:()=>T(null),className:"absolute top-4 right-4 p-2 bg-black/50 hover:bg-black/70 rounded-full",children:(0,s.jsx)(m.A,{className:"w-6 h-6 text-white"})})]})})}),C&&(0,s.jsx)("div",{className:"fixed bottom-4 right-4 bg-black/70 backdrop-blur-sm rounded-lg p-4 text-white",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(d.A,{size:16}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"text-sm mb-1",children:["업로드 중... ",Math.round(D),"%"]}),(0,s.jsx)("div",{className:"w-48 bg-gray-600 rounded-full h-1",children:(0,s.jsx)("div",{className:"bg-green-500 h-1 rounded-full transition-all duration-300",style:{width:"".concat(D,"%")}})})]})]})})]})}},6989:(e,t,a)=>{a.d(t,{z:()=>i});var s=a(2115);function i(){let[e,t]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=()=>{try{let e=localStorage.getItem("redux_admin_session");if(!e){t(!1),i(null);return}let a=JSON.parse(e),s=new Date().getTime();if(a.expiry<=s){localStorage.removeItem("redux_admin_session"),t(!1),i(null);return}t(!0),i(a)}catch(e){console.error("Error checking admin session:",e),t(!1),i(null)}};e();{let t=t=>{"redux_admin_session"===t.key&&e()};window.addEventListener("storage",t);let a=setInterval(e,6e4);return()=>{window.removeEventListener("storage",t),clearInterval(a)}}},[]),{isAdmin:e,adminData:a,login:(e,a)=>{if("admin"===e&&"redux2025"===a){let a={expiry:new Date().getTime()+864e5,username:e};return localStorage.setItem("redux_admin_session",JSON.stringify(a)),t(!0),i(a),!0}return!1},logout:()=>{localStorage.removeItem("redux_admin_session"),t(!1),i(null)}}}},6265:(e,t,a)=>{a.d(t,{Nu:()=>n});var s=a(9209),i=a.n(s),l=a(2818);a(5927).Buffer;let r={publicKey:"public_2BXoL4/MDWL0GjI21rq6iIG1TF8=",urlEndpoint:"https://ik.imagekit.io/t914"};function n(e,t){if(e.startsWith("http")||e.startsWith("data:"))return e;let a="".concat(r.urlEndpoint).concat(e.startsWith("/")?e:"/".concat(e));if(t){let e=new URLSearchParams;t.width&&e.append("tr","w-".concat(t.width)),t.height&&e.append("tr","h-".concat(t.height)),t.quality&&e.append("tr","q-".concat(t.quality)),t.format&&e.append("tr","f-".concat(t.format)),t.crop&&e.append("tr","c-".concat(t.crop)),t.focus&&e.append("tr","fo-".concat(t.focus)),e.toString()&&(a+="?".concat(e.toString()))}return a}new(i())({publicKey:r.publicKey,privateKey:l.env.IMAGEKIT_PRIVATE_KEY,urlEndpoint:r.urlEndpoint})},4199:(e,t,a)=>{a.d(t,{bK:()=>i,qG:()=>s});let s={initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{duration:.6,ease:[.4,0,.2,1]}},exit:{opacity:0,y:-20,transition:{duration:.3,ease:[.4,0,.2,1]}}},i={animate:{transition:{staggerChildren:.1,delayChildren:.2}}}}}]);